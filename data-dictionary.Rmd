---
title: "Indiana COVID-19 Tracker Data Dictionary"
author: "Eric Book"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: 
      html_document:
            toc: TRUE
            toc_float: TRUE
---


```{r, setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE,
                      out.width = "100%",
                      collapse = TRUE)

library(readr)
library(glue)
library(dplyr)
library(gt)
library(gtsummary)
```

Data files described in this dictionary are located in the [data directory](https://github.com/ercbk/Indiana-COVID-19-Tracker/tree/master/data) of this repository.  
\
\

## Historical Weekly COVID-19 Cases by Age  

#### Description  
Processed data for [heatmaps](https://ercbk.github.io/Indiana-COVID-19-Website/demographics.html#cases-by-age) that shows a breakdown of weekly COVID-19 cases by age group.  

#### File name
age-cases-heat.rds  

#### Scripts  
Collection: [build-datasets.R](https://github.com/ercbk/Indiana-COVID-19-Tracker/blob/master/R/collection/build-datasets.R)  
Processing: [process-demog-data.R](https://github.com/ercbk/Indiana-COVID-19-Tracker/blob/master/R/process/process-demog-data.R)  
Chart: [demographics.Rmd](https://github.com/ercbk/Indiana-COVID-19-Website/blob/gh-pages/demographics.Rmd)  

#### Raw Sources
Indiana Data Hub: [COVID-19 CASE DEMOGRAPHICS](https://hub.mph.in.gov/dataset/covid-19-case-demographics)  
tidycensus R package: [website](https://walker-data.com/tidycensus/), 2018 age populations for Indiana  

#### Notes  
Other variables:  
- `end_date`: ordered factor; date of the last day of the weekly interval  
- `daily_cases`: Vestigial column that was used during processing  
- `pop`: Vestigial column used to calculate `prop_cases`  
\

```{r, asis=TRUE}

ach <- read_rds("data/age-cases-heat.rds")
ach_var_defs <- c("Age group",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "Weekly count of COVID-19 confirmed cases by age group",
                  "Number of cases scaled to per 1000 residents per age group")

# table width responsive to length of var_defs text, so may not appear full.width
# use show_header_names to get col names being used by tbl_summary
tbl_summary(ach,
            missing = "ifany",
            missing_text = "Missing",
            include = c(age_grp, weekly_cases, prop_cases)) %>% 
  modify_header(update = list(
    label ~ 'Variable')) %>% 
  modify_table_body(dplyr::mutate, defs = ach_var_defs) %>% 
  modify_header(defs = "Definition") %>% 
  # show_header_names()
  as_gt() %>%
  tab_options(table.align = "left") %>% 
  cols_align("left", vars(stat_0, defs)) %>%
  as_raw_html()

```
\
\
\

## Historical Weekly COVID-19 Deaths by Age Group   

#### Description  
Processed data for [line charts](https://ercbk.github.io/Indiana-COVID-19-Website/demographics.html#deaths-by-age) that shows counts and trends of weekly COVID-19 deaths by age group.  

#### File name
age-death-line.rds  

#### Scripts  
Collection: [build-datasets.R](https://github.com/ercbk/Indiana-COVID-19-Tracker/blob/master/R/collection/build-datasets.R)  
Processing: [process-demog-data.R](https://github.com/ercbk/Indiana-COVID-19-Tracker/blob/master/R/process/process-demog-data.R)  
Chart: [demographics.Rmd](https://github.com/ercbk/Indiana-COVID-19-Website/blob/gh-pages/demographics.Rmd)  

#### Raw Sources
Indiana Data Hub: [COVID-19 CASE DEMOGRAPHICS](https://hub.mph.in.gov/dataset/covid-19-case-demographics)

#### Notes  
Other variables:  
- `end_date`: date of the last day of the weekly interval  
- `date_text`: date label for the chart  
- `tooltip`: pop-up text for points in chart with death counts and date  
\

```{r, asis=TRUE}

adl <- read_rds("data/age-death-line.rds")
adl_var_defs <- c("Age group",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "Weekly count of COVID-19 confirmed deaths by age group")

# table width responsive to length of var_defs text, so may not appear full.width
# use show_header_names to get col names being used by tbl_summary
tbl_summary(adl,
            missing = "ifany",
            missing_text = "Missing",
            include = c(agegrp, weekly_total)) %>% 
  modify_header(update = list(
    label ~ 'Variable')) %>% 
  modify_table_body(dplyr::mutate, defs = adl_var_defs) %>% 
  modify_header(defs = "Definition") %>% 
  # show_header_names()
  as_gt() %>%
  tab_options(table.align = "left") %>% 
  cols_align("left", vars(stat_0, defs)) %>%
  as_raw_html()

```

\
\
\

## Historical Daily COVID-19 Hospital Admissions by Age Group   

#### Description  
Raw data for [line charts](https://ercbk.github.io/Indiana-COVID-19-Website/hospitals.html#state-hospital-mortality-staffing-shortages-admissions) that shows daily COVID-19 hospital admissions by age group and gender.  

#### File name
age-hosp-line.rds  

#### Scripts  
Collection: [scrape-regenstrief-tableau.R](https://github.com/ercbk/Indiana-COVID-19-Tracker/blob/master/R/collection/scrape-regenstrief-tableau.R)  
Processing: [process-hosp-data.R](https://github.com/ercbk/Indiana-COVID-19-Tracker/blob/master/R/process/process-hospitals-data.R)  
Chart: [hospitals.Rmd](https://github.com/ercbk/Indiana-COVID-19-Website/blob/gh-pages/hospitals.Rmd)  

#### Raw Sources
Regenstrief Institute: [dashboard](https://www.regenstrief.org/covid-dashboard/)

#### Notes  
This dataset is incomplete with random gaps between days.  

Other variables:  
- `date`: yyyy-mm-dd format  
\

```{r, asis=TRUE}

ahl <- read_rds("data/age-hosp-line.rds")
ahl_var_defs <- c("Age group",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "",
                  "Daily COVID-19 male hospital admissions by age group",
                  "Daily COVID-19 female hospital admissions by age group",
                  "Daily COVID-19 total hospital admissions by age group")

# table width responsive to length of var_defs text, so may not appear full.width
# use show_header_names to get col names being used by tbl_summary
tbl_summary(ahl,
            missing = "ifany",
            missing_text = "Missing") %>% 
  modify_header(update = list(
    label ~ 'Variable')) %>% 
  modify_table_body(dplyr::mutate, defs = ahl_var_defs) %>% 
  modify_header(defs = "Definition") %>% 
  # show_header_names()
  as_gt() %>%
  tab_options(table.align = "left") %>% 
  cols_align("left", vars(stat_0, defs)) %>%
  as_raw_html()

```
\
\
\

## Historical Daily ICU Beds and Ventilators  

#### Description  
Raw data for [Hospitalizations, ICU Beds and Ventilator Availability](https://ercbk.github.io/Indiana-COVID-19-Website/static.html#Hospitalizations,_ICU_Beds_and_Ventilator_Availability) that shows resource counts of ICU beds and ventilators.  

#### File name
beds-vents-complete.csv  

#### Scripts  
Collection: [build-datasets.R](https://github.com/ercbk/Indiana-COVID-19-Tracker/blob/master/R/collection/build-datasets.R)  
Chart: [hosp-icu-vent.R](https://github.com/ercbk/Indiana-COVID-19-Tracker/blob/master/R/static-charts/hosp-icu-vent.R)  

#### Raw Sources
Indiana Data Hub: [COVID-19 BEDS AND VENTS](https://hub.mph.in.gov/dataset/covid-19-beds-and-vents)

#### Notes  
The source publishs daily excel spreadsheets with total resource counts, and these spreadsheets are collected and joined daily to produce a dataset with historical values.  

Other variables:  
- `date`: yyyy-mm-dd format  
\

```{r, asis=TRUE}

bvc <- read_csv("data/beds-vents-complete.csv")
bvc_var_defs <- c("Total ICU beds",
                  "Total ICU beds occupied with COVID-19 patients",
                  "Total available ICU beds",
                  "Total ventilators",
                  "Total ventilators being used by COVID-19 patients",
                  "Total ventilators being used by non-COVID-19 patients",
                  "Total available ventilators")

# table width responsive to length of var_defs text, so may not appear full.width
# use show_header_names to get col names being used by tbl_summary
tbl_summary(bvc,
            missing = "ifany",
            missing_text = "Missing") %>% 
  modify_header(update = list(
    label ~ 'Variable')) %>% 
  modify_table_body(dplyr::mutate, defs = bvc_var_defs) %>% 
  modify_header(defs = "Definition") %>% 
  # show_header_names()
  as_gt() %>%
  tab_options(table.align = "left") %>% 
  cols_align("left", vars(stat_0, defs)) %>%
  as_raw_html()

```
\
\
\

## Historical State Hospital Staff Shortages, Hospital Mortality Rate, Hospital Admissions and Ages Skewness of Admissions 

#### Description  
Processed data for [line charts](https://ercbk.github.io/Indiana-COVID-19-Website/hospitals.html#state-hospital-mortality-staffing-shortages-admissions) that shows state hospital staff shortages, hospital mortality rate, hospital admissions, and age skewness of hospital admissions towards older patients.  

#### File name
hosp-msas-line.rds  

#### Scripts  
Collection: [scrape-regenstrief-tableau.R](https://github.com/ercbk/Indiana-COVID-19-Tracker/blob/master/R/collection/scrape-regenstrief-tableau.R)  
Process: [process-hospitals-data.R](https://github.com/ercbk/Indiana-COVID-19-Tracker/blob/master/R/process/process-hospitals-data.R)  
Chart: [hospitals.Rmd](https://github.com/ercbk/Indiana-COVID-19-Website/blob/gh-pages/hospitals.Rmd)  

#### Raw Sources
Regenstrief Institute: [dashboard](https://www.regenstrief.org/covid-dashboard/)  
Department of Health and Human Services: [COVID-19 Reported Patient Impact and Hospital Capacity by State Timeseries](https://beta.healthdata.gov/Hospital/COVID-19-Reported-Patient-Impact-and-Hospital-Capa/g62h-syeh)  
Department of Health and Human Services: [COVID-19 Reported Patient Impact and Hospital Capacity by Facility](https://beta.healthdata.gov/Hospital/COVID-19-Reported-Patient-Impact-and-Hospital-Capa/anag-cw7u)  

#### Notes  
Other variables:  
- `date`: Ordered factor, Month Day format  
\

```{r, asis=TRUE}

msas <- read_rds("data/hosp-msas-line.rds")
msas_var_defs <- c("Percent of reporting hospitals that have reported staffing shortages for that day. That percentage is averaged over a rolling, seven day window",
                   "Ratio of deaths of hospitalized COVID-19 patients and unique COVID-19 hospital admissions. Each rate is calculated over a rolling, 14-day window",
                   "Daily total of unique individuals that have tested positive for COVID-19 and been admitted to a hospital on the that day. Those daily counts are averaged over a rolling, seven day window",
                   "Measurement of the age makeup of the COVID-19 hospital admissions data. It's calculated over a rolling, 14 day window")

# table width responsive to length of var_defs text, so may not appear full.width
# use show_header_names to get col names being used by tbl_summary
tbl_summary(msas %>% select(-date),
            missing = "ifany",
            missing_text = "Missing") %>% 
  modify_header(update = list(
    label ~ 'Variable')) %>% 
  modify_table_body(dplyr::mutate, defs = msas_var_defs) %>% 
  modify_header(defs = "Definition") %>% 
  # show_header_names()
  as_gt() %>%
  tab_options(table.align = "left") %>% 
  cols_align("left", vars(stat_0, defs)) %>%
  cols_width(vars(stat_0) ~ px(150)) %>% 
  as_raw_html()

```
\
\
\

## Local Hospital Capacity

#### Description  
Processed data for the [Local Hospital Capacity table](https://ercbk.github.io/Indiana-COVID-19-Website/hospitals.html#local-hospital-capacity) that shows capacity measures and counts of COVID-19 patients for hospitals at the local level.  

#### File name
hosp-react-tab.rds  

#### Scripts  
Process: [process-hospitals-data.R](https://github.com/ercbk/Indiana-COVID-19-Tracker/blob/master/R/process/process-hospitals-data.R)  
Chart: [hospitals.Rmd](https://github.com/ercbk/Indiana-COVID-19-Website/blob/gh-pages/hospitals.Rmd)  

#### Raw Sources
Department of Health and Human Services: [COVID-19 Reported Patient Impact and Hospital Capacity by State Timeseries](https://beta.healthdata.gov/Hospital/COVID-19-Reported-Patient-Impact-and-Hospital-Capa/g62h-syeh)  

#### Notes  
Other variables:  
- `end_date`: date, yyyy-mm-dd format, end date of week interval  
- `hospital_name`: char, Name of hospital  
- `address`: char, Street address of hospital  
- `city_zip`: char, City and zip code  
- `county_name`: char, Name of county  
- `avgCovIceuTenKList`: nested list, `end_date` and average daily number of ICU beds being used by confirmed and suspected COVID-19 patients over the weekly interval  
- `avgCovHospTenKList`: nested list, `end_date` and average daily number of hospital beds being used by confirmed and suspected COVID-19 patients over the weekly interval  
- `avgTotImpBedsList`: `end_date` and average daily number of staffed total beds available over the weekly interval  
\

```{r, asis=TRUE}

hrt <- read_rds("data/hosp-react-tab.rds")
hrt_var_defs <- c("Proportion of the seven-day average of occupied ICU beds to the seven-day average of available ICU beds.",
                  "",
                  "Proportion of the seven-day average of occupied hospital beds to the seven-day average of available hospital beds proportion of the seven-day average of occupied hospital beds to the seven-day average of available hospital beds.",
                  "")

# table width responsive to length of var_defs text, so may not appear full.width
# use show_header_names to get col names being used by tbl_summary
tbl_summary(hrt %>% select(sev_day_icu_perc_occup, sev_day_hosp_perc_occup),
            missing = "ifany",
            missing_text = "Missing") %>% 
  modify_header(update = list(
    label ~ 'Variable')) %>% 
  modify_table_body(dplyr::mutate, defs = hrt_var_defs) %>% 
  modify_header(defs = "Definition") %>% 
  # show_header_names()
  as_gt() %>%
  tab_options(table.align = "left") %>% 
  cols_align("left", vars(stat_0, defs)) %>%
  cols_width(vars(stat_0) ~ px(150)) %>% 
  as_raw_html()

```
\
\
\

